### 用例详述 1：扫码签到 (Sign In)

*   **用例编号：** BUC01
*   **参与者：** 学生
*   **前置条件：** 学生已完成挂号（存在当天的有效挂号记录），且尚未进入候诊队列。
*   **后置条件：** 学生状态变为“候诊中”，并被追加到候诊队列的队尾。

**主成功场景 (MSS)：**
1.  学生在科室门口使用手机扫描“签到二维码”。
2.  系统请求获取学生当前位置及身份信息以防止远程作弊。
3.  系统校验该学生是否存在该科室当天的未就诊挂号记录。
4.  系统将学生状态由“已挂号”更新为“候诊中”。
5.  系统将该学生对象追加到**“科室候诊队列”**的末尾。
6.  系统向学生手机返回“签到成功”提示，显示当前排队号码及前方等待人数。

**扩展场景 (Extensions)：**
1.  **无挂号记录：** 系统提示“未查询到挂号信息，请先前往自助机挂号”，流程结束。
2.  **重复签到：** 系统检测到学生已在队列中，提示“您已在队列中，请勿重复签到”，显示当前进度。

---

### 用例详述 2：呼叫病号 (Call Patient)

*   **用例编号：** BUC04
*   **参与者：** 医生
*   **前置条件：** 医生状态为“坐诊中”，且科室候诊队列不为空。
*   **后置条件：** 候诊队列队首学生被移除，状态变为“就诊中”，且该学生被绑定给当前医生。

**主成功场景 (MSS)：**
1.  医生在工作台点击“叫号”按钮。
2.  系统锁定**“科室候诊队列”**中的第一位学生（防止多位医生并发冲突）。
3.  系统执行**自动分配逻辑**：将该学生分配给当前操作的医生。
4.  系统将学生状态更新为“呼叫中/就诊中”。
5.  系统触发走廊大屏显示“请 XX 号 XXX 到 XX 诊室就诊”并播放语音。
6.  系统向学生手机发送“轮到您了，请立即前往诊室”的推送通知。
7.  系统刷新医生工作台界面，加载该学生的电子病历档案。

**扩展场景 (Extensions)：**
1.  **队列为空：** 系统提示“当前无候诊病人”，不执行叫号动作。

---

### 用例详述 3：处理过号重排 (Handle Missed Call Re-queuing)

*   **用例编号：** BUC06
*   **参与者：** 护士
*   **前置条件：** 学生状态为“过号（Missed）”，且已回到分诊台申请重排。
*   **后置条件：** 学生重新进入候诊队列，位置处于当前叫号位之后第 3 位。

**主成功场景 (MSS)：**
1.  护士在系统输入学生姓名或扫描其挂号单，查询学生记录。
2.  系统显示学生当前状态为“过号”。
3.  护士点击“过号重排（激活）”按钮。
4.  系统获取当前正在就诊（或正在呼叫）的号码位置 $N$。
5.  系统计算插入位置：$Target = N + 3$ （即**顺延 3 位**策略）。
6.  系统将学生插入到队列的 $Target$ 位置（若队列长度不足 3，则插入队尾）。
7.  系统提示“重排成功”，并更新该学生的排队序号。

**扩展场景 (Extensions)：**
1.  **非过号状态：** 若学生状态是“候诊中”或“已完成”，系统提示“该学生不符合过号重排条件”，拒绝操作。
2.  **重复重排：** 若学生今日已重排超过限制次数（如 3 次），系统提示“重排次数超限，请重新挂号”。