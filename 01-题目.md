### 一、 核心目标

本实验不仅仅是画UML图，而是要体验**“AI辅助开发”**的全流程。
你需要利用 **大模型（Kimi）** 生成模型和代码，利用 **知识图谱（Neo4j）** 管理需求到代码的追踪链，最终完成一个从需求获取到变更管理的闭环。

---

### 二、 工具准备（实验前务必配置好）

建议以 **VS Code** 为核心工作台：

1. **IDE:** VS Code (安装插件：PlantUML, 通义灵码/Copilot)。
2. **大模型:** Kimi (kimi.moonshot.cn)，用于生成PlantUML代码和Java/Python代码。
3. **绘图:** PlantUML（在VS Code中配合Graphviz Preview插件可直接看图）。
4. **知识图谱:** Neo4j AuraDB（云端）或本地安装，用于存储追踪关系。
5. **环境:** Java (Spring Boot) 或 Python (FastAPI) 运行环境。

---

### 三、 任务流程分解（共五个阶段）

#### 阶段 1：业务获取（从录音到用例图）

* **输入：** 模拟一段访谈录音（如“医院候诊系统”），转为文字（MD格式）。
* **任务：**
    1. 把访谈文本投喂给 Kimi。
    2. 要求 Kimi 提取**参与者**和**业务用例**（动词+名词）。
    3. 要求 Kimi 生成 **业务术语表** 和 **PlantUML 格式的用例图**。
    4. 在 VS Code 中预览并人工校验（检查是否有遗漏角色，用例是否准确）。
* **产出：** 业务用例图、业务术语表。

#### 阶段 2：需求建模（细化功能与流程）

* **输入：** 阶段1的用例图。
* **任务：**
    1. 让 Kimi 将用例细化为 **功能清单**（一级->二级）。
    2. 挑选 3 个核心用例，让 Kimi 写出 **详细描述**（主场景、扩展场景）。
    3. 让 Kimi 为每个用例生成 **PlantUML 活动图**（带泳道）。
    4. 生成 **系统级用例图**（加上系统边界框）。
* **产出：** 功能清单、用例详述、活动图、系统用例图。

#### 阶段 3：架构与设计（类图与交互图 + 知识图谱初始化）

* **输入：** 用例详述。
* **任务：**
    1. 让 Kimi 根据用例生成 **类图**（含类名、属性、关联），并要求加上追踪标记（`需求追踪：对应UC编号`）。
    2. **人工微调** 类图（拆分不合理的类，补充关联）。
    3. 针对核心场景，生成 **PlantUML 序列图**。
    4. **关键步骤：** 运行实验提供的 `kg_build.py` 脚本，解析 PlantUML 文件，将设计节点存入 Neo4j 知识图谱。
* **产出：** 类图、包图、序列图、Neo4j 中的初步图谱。

#### 阶段 4：代码生成与双向追踪

* **输入：** 类图。
* **任务：**
    1. 让 Kimi 根据类图生成 **Spring Boot (Java) 或 FastAPI (Python)** 代码骨架。
    2. **要求：** 代码中必须包含 `@trace UCxx` 这样的注释标记。
    3. 本地运行代码，确保接口可访问（如 Swagger UI）。
    4. **关键步骤：** 运行 `kg_trace.py` 脚本，扫描代码注释，将“代码”节点连接到 Neo4j 中的“类”节点。
* **产出：** 可运行的代码骨架、完整的“需求-类-代码”追踪链。

#### 阶段 5：变更管理（模拟需求变更）

* **场景：** 假设需求变更（如：增加“预约签到”功能）。
* **任务：**
    1. **影响分析：** 在 Neo4j 中运行查询语句，高亮显示该变更会影响哪些类、哪些代码文件。
    2. **增量生成：** 让 Kimi 根据变更，生成新的 SQL 和 单元测试代码。
* **产出：** 变更影响分析截图、增量代码。

---

### 四、 成果提交清单（实验报告）

你需要建立一个文件夹（如 `demo_project`），包含以下子文件夹和内容：

1. **1_biz/**：访谈原始文本、业务用例图。
2. **2_req/**：功能清单、用例详述文档、活动图。
3. **3_design/**：类图、序列图、包图。
4. **4_code/**：生成的工程代码（src目录等）。
5. **5_change/**：Neo4j 的影响分析截图、变更后的代码片段。
6. **kg_dump/**：Neo4j 导出的数据文件（可选）。
7. **实验报告文档**：整合以上内容，按标准格式撰写。

---

### 五、 重要注意事项（避坑指南）

1. **Prompt（提示词）是关键：**
    
    * 如果 Kimi 生成的结果不好（如属性乱造），请把“业务术语表”再次贴给它，限制它“只使用表中的词汇”。
    * 明确要求输出格式为 PlantUML，可以直接复制到 VS Code 看图。
2. **知识图谱脚本：**
    
    * 实验中提到的 `kg_build.py` 和 `kg_trace.py` 是实验提供的自动化脚本。如果你没有这两个脚本，**必须向老师或助教索要**，或者你需要自己编写简单的脚本来解析文本并存入 Neo4j（这难度较大，通常是实验包里有的）。
    * 如果脚本运行报错，检查 Neo4j 的端口配置。
3. **保持一致性：**
    
    * 类图中的类名必须和代码中的类名一致，否则追踪脚本无法建立连接。
    * 注释中的 `@trace` 标记必须准确对应到用例编号。
4. **时间节点：**
    
    * 实验报告需在 **第16周前** 提交。建议尽早完成环境配置和脚本测试。
5. **没有显卡？**
    
    * 不用担心，本实验主要依赖云端大模型（Kimi）和云端/轻量级图数据库，对本地显卡无要求。
